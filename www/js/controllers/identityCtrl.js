define(["./module"],function(e){e.controller("identityCtrl",["$scope","$rootScope","validateService","messageService","httpService","userService",function(e,o,s,n,i,t){e.showPhone=o.showPhone=!0,e.showEmail=o.showEmail=!1,e.user={};var a=/^((145|147)|(15[^4])|(17[6-8])|((13|18)[0-9]))\d{8}$/,h=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;e.choosePhone=function(){o.showPhone=e.showPhone=!0,o.showEmail=e.showEmail=!1},e.chooseEmail=function(){o.showPhone=e.showPhone=!1,o.showEmail=e.showEmail=!0},e.getValiCode=function(){var o=e.user.phone;if(""===o)n.show("请输入手机号码");else if(a.test(o)){var s=i.getData("./json/change-password.json",e.user.phone);s.then(function(e){n.show("获取短信成功")})}else n.show("请输入正确的手机号码格式")},e.submit=function(){if(e.showPhone===!0){var o,r;if(o=s.isEmpty(".j-valiPhone input"),1!==o)return n.show(o),!1;if(a.test(e.user.phone)){r=s.submitData(".j-valiPhone");var w=i.getData("./json/change-password.json",r);w.then(function(o){t.user.phone=e.user.phone,window.location="./#/reset-pwd"})}else n.show("请输入正确的手机号码格式")}else{var l,u;if(l=s.isEmpty(".j-valiEmail input"),1!==l)return n.show(l),console.log(l),!1;if(h.test(e.user.email)){u=s.submitData(".j-valiEmail");var c=i.getData("./json/change-password.json",u);c.then(function(o){t.user.email=e.user.email,window.location="./#/reset-pwd"})}else n.show("请输入正确的邮箱格式")}}}])});